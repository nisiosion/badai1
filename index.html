<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<!-- ダブルタップ拡大防止 -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>場代計算</title>

<style>
html, body {
  touch-action: manipulation;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  max-width: 500px;
  margin: auto;
  padding: 15px;
  background: #f4f4f4;
}

h2 { text-align: center; }

.section {
  background: white;
  padding: 15px;
  margin-top: 15px;
  border-radius: 12px;
}

label {
  font-weight: bold;
  display: block;
  margin-top: 10px;
}

select, input[type="time"] {
  width: 100%;
  padding: 12px;
  font-size: 18px;
  border-radius: 8px;
  border: 1px solid #ccc;
}

.counter {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 8px;
}

.counter button {
  width: 60px;
  height: 55px;
  font-size: 24px;
  border-radius: 10px;
  border: none;
  background: #1976d2;
  color: white;
}

.count {
  font-size: 24px;
  font-weight: bold;
}

.result {
  font-size: 20px;
  font-weight: bold;
  margin-top: 8px;
}

.total {
  font-size: 28px;
  font-weight: bold;
  color: #d32f2f;
  text-align: center;
}
</style>
</head>

<body>

<h2>場代計算</h2>

<div class="section">
<label>開始時間</label>
<input type="time" id="startTime" onchange="calc()">

<label>終了時間</label>
<input type="time" id="endTime" onchange="calc()">

<div class="result">
利用時間：<span id="hours">0</span> 時間
</div>
</div>

<div class="section">
<label>場代（1時間）</label>
<select id="rate" onchange="calc()">
  <option value="1880">1880</option>
  <option value="2400">2400</option>
  <option value="3300">3300</option>
</select>

<div class="result">
場代合計：<span id="tableTotal">0</span> 円
</div>
</div>

<div class="section">

<label>ソフトドリンク（330円）</label>
<div class="counter">
<button onclick="change('soft',-1)">−</button>
<div class="count" id="soft">0</div>
<button onclick="change('soft',1)">＋</button>
</div>

<label>アルコール（600円）</label>
<div class="counter">
<button onclick="change('alcohol',-1)">−</button>
<div class="count" id="alcohol">0</div>
<button onclick="change('alcohol',1)">＋</button>
</div>

<label>出前（円）</label>
<input type="number" id="delivery" value="0" oninput="calc()">

<label>マージン（円）</label>
<input type="number" id="margin" value="0" oninput="calc()">

<div class="result">
飲食代合計：<span id="foodTotal">0</span> 円
</div>

</div>

<div class="section total">
総合計：<span id="grandTotal">0</span> 円
</div>

<script>
const alcoholPrice = 600;
const softPrice = 330;

function change(id, delta) {
  let value = Number(document.getElementById(id).textContent);
  value += delta;
  if (value < 0) value = 0;
  document.getElementById(id).textContent = value;
  calc();
}

function calc() {
  const start = document.getElementById("startTime").value;
  const end = document.getElementById("endTime").value;
  let hours = 0;

  if (start && end) {
    const s = new Date(`2000-01-01T${start}`);
    let e = new Date(`2000-01-01T${end}`);
    if (e < s) e.setDate(e.getDate() + 1);
    const diff = (e - s) / (1000 * 60 * 60);
    hours = Math.ceil(diff * 2) / 2; // 30分切り上げ
  }

  document.getElementById("hours").textContent = hours;

  const rate = Number(document.getElementById("rate").value);
  const tableTotal = rate * hours;
  document.getElementById("tableTotal").textContent = tableTotal.toLocaleString();

  const soft = Number(document.getElementById("soft").textContent) * softPrice;
  const alcohol = Number(document.getElementById("alcohol").textContent) * alcoholPrice;
  const delivery = Number(document.getElementById("delivery").value);
  const margin = Number(document.getElementById("margin").value);

  const foodTotal = soft + alcohol + delivery + margin;
  document.getElementById("foodTotal").textContent = foodTotal.toLocaleString();

  const grandTotal = tableTotal + foodTotal;
  document.getElementById("grandTotal").textContent = grandTotal.toLocaleString();
}
</script>

</body>
</html>
