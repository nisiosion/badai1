<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>場代計算アプリ</title>
<style>
body { font-family: sans-serif; max-width: 400px; margin: auto; }
input, select { width: 100%; padding: 8px; margin: 5px 0; }
.result { font-weight: bold; margin-top: 10px; }
</style>
</head>
<body>

<h2>場代計算アプリ</h2>

<label>開始時間</label>
<input type="time" id="startTime" onchange="calc()">

<label>終了時間</label>
<input type="time" id="endTime" onchange="calc()">

<div class="result">
利用時間：<span id="totalHours">0</span> 時間
</div>

<label>場代（1時間）</label>
<select id="rate" onchange="calc()">
  <option value="1880">1880</option>
  <option value="2400">2400</option>
  <option value="3300">3300</option>
</select>

<label>ソフトドリンク人数（330円）</label>
<select id="soft" onchange="calc()">
  <option value="0">0</option>
  <option value="990">3人 (990円)</option>
  <option value="1320">4人 (1320円)</option>
</select>

<hr>

<h3>アルコール（1杯600円）</h3>

<label>生ビール（600円）</label>
<input type="number" id="beer" value="0" oninput="calc()">

<label>ハイボール（600円）</label>
<input type="number" id="highball" value="0" oninput="calc()">

<label>焼酎（600円）</label>
<input type="number" id="shochu" value="0" oninput="calc()">

<hr>

<label>出前（円）</label>
<input type="number" id="delivery" value="0" oninput="calc()">

<label>マージン（円）</label>
<input type="number" id="margin" value="0" oninput="calc()">

<div class="result">
飲食代合計：<span id="foodTotal">0</span> 円
</div>

<div class="result">
合計金額：<span id="grandTotal">0</span> 円
</div>

<script>
const alcoholPrice = 600;

function calc() {
  const start = document.getElementById("startTime").value;
  const end = document.getElementById("endTime").value;

  let hours = 0;

  if (start && end) {
    const startDate = new Date(`2000-01-01T${start}`);
    let endDate = new Date(`2000-01-01T${end}`);

    if (endDate < startDate) {
      endDate.setDate(endDate.getDate() + 1);
    }

    const diffMs = endDate - startDate;
    const diffHours = diffMs / (1000 * 60 * 60);

    // 30分単位切り上げ
    hours = Math.ceil(diffHours * 2) / 2;
  }

  document.getElementById("totalHours").textContent = hours;

  const rate = Number(document.getElementById("rate").value);
  const soft = Number(document.getElementById("soft").value);

  const beer = Number(document.getElementById("beer").value) * alcoholPrice;
  const highball = Number(document.getElementById("highball").value) * alcoholPrice;
  const shochu = Number(document.getElementById("shochu").value) * alcoholPrice;

  const delivery = Number(document.getElementById("delivery").value);
  const margin = Number(document.getElementById("margin").value);

  const foodTotal = soft + beer + highball + shochu + delivery + margin;
  const grandTotal = rate * hours + foodTotal;

  document.getElementById("foodTotal").textContent = foodTotal.toLocaleString();
  document.getElementById("grandTotal").textContent = grandTotal.toLocaleString();
}
</script>

</body>
</html>
